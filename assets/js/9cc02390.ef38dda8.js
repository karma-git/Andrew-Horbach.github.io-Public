"use strict";(self.webpackChunkclassic=self.webpackChunkclassic||[]).push([[6366],{8936:function(n){n.exports=JSON.parse('{"blogPosts":[{"id":"terraformer","metadata":{"permalink":"/Andrew-Horbach.github.io-Public/blog/terraformer","editUrl":"https://github.com/karma-git/Andrew-Horbach.github.io-Public/blob/master/blog/2022-12-05-terraformer.md","source":"@site/blog/2022-12-05-terraformer.md","title":"Terraformer - reverse Terraform","description":"Terraformer - reverse Terraform","date":"2022-12-05T00:00:00.000Z","formattedDate":"December 5, 2022","tags":[{"label":"aws","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/aws"},{"label":"terraform","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/terraform"}],"readingTime":0.715,"truncated":false,"authors":[{"name":"Andrew Horbach","url":"https://github.com/karma-git","imageURL":"https://github.com/karma-git.png","key":"a.horbach"}],"nextItem":{"title":"Kubed - secret sync between k8s clusters in different aws accounts","permalink":"/Andrew-Horbach.github.io-Public/blog/kubed-cross-sync"}},"content":"## \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435\\n\\nhttps://github.com/GoogleCloudPlatform/terraformer\\n\\n**Terraformer** - \u0442\u0443\u043b\u0437\u0430 \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u044e\u0449\u0430\u044f \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u043e\u0431\u043b\u0430\u0447\u043d\u044b\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b \u0432 `terraform \u043a\u043e\u0434`. \u041c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u043e\u043b\u0435\u0437\u043d\u0430 \u0432 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0445 \u043a\u0435\u0439\u0441\u0430\u0445, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: \u043f\u0440\u0438 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0438 aws-\u0443 \u0438 terraform-\u0443 - \u0441\u043e\u0437\u0434\u0430\u043b\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u044b \u0447\u0435\u0440\u0435\u0437 console \u043f\u043e \u043a\u0443\u0440\u0441\u0443, \u0430 \u043f\u043e\u0442\u043e\u043c \u0434\u0430\u043c\u043f\u043d\u0443\u043b\u0438 \u044d\u0442\u043e \u0432 terraform \u043a\u043e\u0434. \u041b\u0438\u0431\u043e \u0431\u043e\u043b\u0435\u0435 \u043a\u043b\u0430\u0441\u0441\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u043a\u0435\u0439\u0441 - \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0443\u044e \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443 \u0432 IaC.\\n\\n## \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\\n\\n:::info\\n\\n\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u043e\u0441\u044c \u0432\u043e\u0442 \u0442\u0430\u043a, \u043d\u043e \u044d\u0442\u043e \u0432\u0440\u044f\u0434 \u043b\u0438 best practices\\n\\n:::\\n\\n\u042d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u0443\u0435\u043c \u043a\u0440\u0435\u0434\u044b \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a aws-apo\\n\\n```shell\\nexport AWS_DEFAULT_PROFILE=my-profile  # ~/.aws/credentials\\nexport AWS_ACCESS_KEY_ID=id\\nexport AWS_SECRET_ACCESS_KEY=key\\n```\\n\\n\u0422\u0430\u043a \u0436\u0435 \u043d\u0430\u043c \u043d\u0443\u0436\u0435\u043d tf \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440 `aws`:\\n\\n```hcl\\nterraform {\\n  required_version = \\">= 1.3.0\\"\\n\\n  required_providers {\\n    aws = {\\n      source  = \\"hashicorp/aws\\"\\n      version = \\"4.42.0\\"\\n    }\\n  }\\n}\\n```\\n\\n\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440, \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c terraformer \u0438 \u043d\u0430\u0442\u0440\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c \u043d\u0430 \u043d\u0443\u0436\u043d\u044b\u0439 \u043d\u0430\u043c aws \u0440\u0435\u0441\u0443\u0440\u0441\\n\\n```shell\\nterraform init # \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440 \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e ./.terraform\\nterraformer import aws --resources=route53 --regions=us-east-1 --profile my-profile\\nterraformer import aws --resources=route53 --regions=us-east-1 --profile my-profile --filter=\\"Type=route53_zone;Name=tags.Name;Value=my.example.com\\"\\n```"},{"id":"kubed-cross-sync","metadata":{"permalink":"/Andrew-Horbach.github.io-Public/blog/kubed-cross-sync","editUrl":"https://github.com/karma-git/Andrew-Horbach.github.io-Public/blob/master/blog/2022-11-22-kubed-cross-sync.md","source":"@site/blog/2022-11-22-kubed-cross-sync.md","title":"Kubed - secret sync between k8s clusters in different aws accounts","description":"Kubed - secret sync between k8s clusters in different aws accounts","date":"2022-11-22T00:00:00.000Z","formattedDate":"November 22, 2022","tags":[{"label":"aws","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/aws"},{"label":"k8s","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/k-8-s"}],"readingTime":6.855,"truncated":false,"authors":[{"name":"Andrew Horbach","url":"https://github.com/karma-git","imageURL":"https://github.com/karma-git.png","key":"a.horbach"}],"prevItem":{"title":"Terraformer - reverse Terraform","permalink":"/Andrew-Horbach.github.io-Public/blog/terraformer"},"nextItem":{"title":"Lens - build from source","permalink":"/Andrew-Horbach.github.io-Public/blog/lens-build"}},"content":"## \u0418\u0441\u0442\u043e\u0440\u0438\u044f, \u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430\\n\\n### 1) aws account mc-legacy\\n\\n![img](https://ah-public-pictures.hb.bizmrg.com/it-happens/kubed-cross-sync-1.jpeg)\\n\\n\u0418\u043c\u0435\u0435\u0442\u0441\u044f legacy \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0432 aws \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0435:\\n\\n1. \u0412 route53 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d \u0434\u043e\u043c\u0435\u043d `<my-company>.io` \u0438 \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u0430\u044f hosted zone\\n2. \u0412 \u0437\u043e\u043d\u0435 \u0435\u0441\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c `<my-service>.<my-company>.io` , \u0441\u043c\u043e\u0442\u0440\u0438\u0442 \u043d\u0430 `<lb>.<my-company>.io`\\n3. \u0411\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u0449\u0438\u043a \u0432\u0435\u0434\u0435\u0442 \u043d\u0430 ASG\\n4. ASG \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 EC2 \u0438\u043d\u0441\u0430\u043d\u0441\u0430\u043c\u0438 \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 `<my-service>`\\n\\n### 2) aws account mc-project\\n\\n![img](https://ah-public-pictures.hb.bizmrg.com/it-happens/kubed-cross-sync-2.jpeg)\\n\\n\u041f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442\u0441\u044f \u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043f\u0435\u0440\u0435\u0432\u0435\u0437\u0442\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0432 kubernetes, \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u043f\u043e\u0434 \u043a\u0430\u0436\u0434\u0443\u044e \u043a\u043e\u043c\u0430\u043d\u0434\u0443 \u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u0441\u0432\u043e\u0439 aws \u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u0438 \u0441\u0432\u043e\u0439 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440:\\n1. \u0412 aws \u043f\u043e\u0434\u043d\u0438\u043c\u0430\u0435\u0442\u0441\u044f NLB \u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u0449\u0438\u043a `<lb-my-project>`\\n2. \u0427\u0435\u0440\u0435\u0437 target groups \u043e\u043d \u0441\u043c\u043e\u0442\u0440\u0438\u0442 \u043d\u0430 EC2 \u0438\u043d\u0441\u0442\u0430\u043d\u0441\u044b, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0437\u0430\u043f\u0443\u0449\u0435\u043d pod \u0441 ingress controller-\u043e\u043c.\\n3. \u041f\u043e\u043f\u0430\u0434\u0430\u044f \u0432 pod \u0438\u043d\u0433\u0440\u0435\u0441\u0441\u0430, \u0437\u0430\u043f\u0440\u043e\u0441 \u0447\u0435\u0440\u0435\u0437 Ingress \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043d\u0430 pod-\u044b \u0437\u0430 `<my-service>` \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e k8s service.\\n\\n### 3) combine\\n\\n![img](https://ah-public-pictures.hb.bizmrg.com/it-happens/kubed-cross-sync-3.jpeg)\\n\\nr53 \u0437\u0430\u043f\u0438\u0441\u044c `<my-service>.<my-company>.io` \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442 \u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043d\u0430 CNAME `<lb-my-project>`, \u0432\u0441\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442, \u043d\u043e SSL \u043d\u0435 \u0442\u0435\u0440\u043c\u0438\u043d\u0438\u0440\u0443\u0435\u0442\u0441\u044f.\\n\\n\u0417\u043e\u043d\u0430 `<my-company>.io` \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u043a\u0440\u0438\u0442\u0438\u0447\u043d\u0430 \u0434\u043b\u044f \u0431\u0438\u0437\u043d\u0435\u0441\u0430, \u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c \u0432 \u043d\u0435\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0430\u043c \u0442\u0438\u043f\u0430 external-dns, cert-manager \u043d\u0435 \u0445\u043e\u0447\u0435\u0442\u0441\u044f.\\n\\n\u0412 \u0442\u043e\u0436\u0435 \u0432\u0440\u0435\u043c\u044f aws \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u043e\u0432 \u0442\u0438\u043f\u0430 `mc-project` \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043c\u043d\u043e\u0433\u043e, \u043a\u0430\u043a \u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u043e\u0432 k8s, \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c \u0441\u0435\u043a\u0440\u0435\u0442 \u0441 tls \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u043c \u043d\u0435 \u0445\u043e\u0447\u0435\u0442\u0441\u044f.\\n\\n### 4) Concept\\n\\n![img](https://ah-public-pictures.hb.bizmrg.com/it-happens/kubed-cross-sync-4.png)\\n\\n1. \u0421\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439 management aws \u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u0438 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440.\\n2. \u0412 \u043d\u0435\u0433\u043e \u043a\u0430\u043a\u0438\u043c-\u0442\u043e \u043e\u0431\u0440\u0430\u0437\u043e\u043c \u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0441\u0435\u043a\u0440\u0435\u0442 \u0441 tls \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u043c `*.<my-company>.io`\\n3. \u0421\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440 [kubed](https://github.com/kubeops/config-syncer) \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u0441\u0435\u043a\u0440\u0435\u0442 `*.<my-company>.io` \u0432 \u0434\u0440\u0443\u0433\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u044b k8s \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0430\u043d\u043d\u043e\u0442\u0430\u0446\u0438\u0439.\\n4. \u0421\u0435\u043a\u0440\u0435\u0442 `*.<my-company>.io` \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0432 Ingress, SSL \u0442\u0440\u0430\u0444\u0444\u0438\u043a \u0442\u0435\u0440\u043c\u0438\u043d\u0438\u0440\u0443\u0435\u0442\u0441\u044f.\\n\\n## \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438\\n\\n:::info\\n\\n\u0412 \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0445 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0445 \u0444\u0430\u0439\u043b\u0430\u0445 \u0440\u043e\u043b\u0438 \u0434\u043b\u044f `mc-mgmt` \u0431\u0443\u0434\u0443\u0442 \u043d\u0430\u0437\u044b\u0432\u0430\u0442\u044c\u0441\u044f `kubed-master`, \u0430 `mc-project-*` - `kubed-follower`\\n\\n:::\\n\\n### AWS IAM RBAC\\n\\nimport Tabs from \'@theme/Tabs\';\\nimport TabItem from \'@theme/TabItem\';\\n\\n:::info\\n\\n\u041d\u0430 \u0441\u0445\u0435\u043c\u0435 `mc-mgmt` = `CI`, `mc-project` - `Target`\\n\\n:::\\n\\n\\n![img](https://ah-public-pictures.hb.bizmrg.com/it-happens/kubed-cross-sync-aws-rbac.png)\\n\\n\u041d\u0443\u0436\u043d\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u043a\u0440\u043e\u0441\u0441-\u0430\u043a\u043a\u0430\u0443\u043d\u0442 aws iam rbac \u0440\u043e\u043b\u0438, \u0434\u043b\u044f \u0442\u043e\u0433\u043e, \u0447\u0442\u043e\u0431\u044b **kubed** \u0438\u0437 `mc-mgmt` \u043c\u043e\u0433 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0441\u0435\u043a\u0440\u0435\u0442\u0430\u043c\u0438 \u0432 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430\u0445 \u0434\u0440\u0443\u0433\u0438\u0445 aws \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u043e\u0432, \u0432 \u0434\u0430\u043d\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435 `mc-project`.\\n\\n#### `mc-mgmt aka kubed-master`\\n\\n<Tabs defaultValue=\\"hcl\\">\\n<TabItem value=\\"hcl\\" label=\\"Terraform\\">\\n\\n```hcl\\nlocals {\\n  kubed_followers_arns = [\\n    for _, id in local.aws_accounts_map : \\"arn:aws:iam::${id}:role/kubed-follower\\"\\n  ]\\n}\\n\\nmodule \\"iam_assumable_role_kubed_master\\" {\\n  source  = \\"terraform-aws-modules/iam/aws//modules/iam-assumable-role-with-oidc\\"\\n  version = \\"4.2.0\\"\\n\\n  create_role = true\\n  role_name   = \\"kubed-master\\"\\n\\n  provider_url = replace(local.cluster_oidc_issuer_url, \\"https://\\", \\"\\")\\n\\n  role_policy_arns = [\\n    aws_iam_policy.kubed_master.arn,\\n    aws_iam_policy.kubed_eks.arn,\\n  ]\\n\\n  oidc_fully_qualified_subjects = [\\n    \\"system:serviceaccount:kube-system:kubed\\"\\n  ]\\n}\\n\\ndata \\"aws_iam_policy_document\\" \\"kubed_master\\" {\\n  statement {\\n    sid    = \\"kubedMaster\\"\\n    effect = \\"Allow\\"\\n    actions = [\\n      \\"sts:AssumeRole\\",\\n    ]\\n    resources = local.kubed_followers_arns\\n  }\\n}\\n\\nresource \\"aws_iam_policy\\" \\"kubed_master\\" {\\n  name   = \\"kubed-master\\"\\n  policy = data.aws_iam_policy_document.kubed_master.json\\n}\\n\\ndata \\"aws_iam_policy_document\\" \\"kubed_eks\\" {\\n  statement {\\n    sid    = \\"kubedEks\\"\\n    effect = \\"Allow\\"\\n    actions = [\\n      \\"eks:DescribeCluster\\",\\n      \\"eks:ListClusters\\"\\n    ]\\n    resources = [\\"*\\"]\\n  }\\n}\\n\\nresource \\"aws_iam_policy\\" \\"kubed_eks\\" {\\n  name   = \\"kubed-eks\\"\\n  policy = data.aws_iam_policy_document.kubed_eks.json\\n}\\n```\\n\\n</TabItem>\\n<TabItem value=\\"trust\\" label=\\"Trust policy\\">\\n\\n```json\\n{\\n    \\"Version\\": \\"2012-10-17\\",\\n    \\"Statement\\": [\\n        {\\n            \\"Sid\\": \\"\\",\\n            \\"Effect\\": \\"Allow\\",\\n            \\"Principal\\": {\\n                \\"Federated\\": \\"arn:aws:iam:::<mc-mgmt_id>:oidc-provider/oidc.eks.<aws_region>.amazonaws.com/id/<mc-mgmt_oidc>\\"\\n            },\\n            \\"Action\\": \\"sts:AssumeRoleWithWebIdentity\\",\\n            \\"Condition\\": {\\n                \\"StringEquals\\": {\\n                    \\"oidc.eks.<aws_region>.amazonaws.com/id/<mc-mgmt_oidc>:sub\\": \\"system:serviceaccount:kube-system:kubed\\"\\n                }\\n            }\\n        }\\n    ]\\n}\\n```\\n\\n</TabItem>\\n<TabItem value=\\"policy-kubed-master\\" label=\\"Policy kubed-master\\">\\n\\n```json\\n{\\n    \\"Version\\": \\"2012-10-17\\",\\n    \\"Statement\\": [\\n        {\\n            \\"Sid\\": \\"kubedMaster\\",\\n            \\"Effect\\": \\"Allow\\",\\n            \\"Action\\": \\"sts:AssumeRole\\",\\n            \\"Resource\\": [\\n                \\"arn:aws:iam::<mc-project_id>:role/kubed-follower\\"\\n            ]\\n        }\\n    ]\\n}\\n```\\n\\n</TabItem>\\n<TabItem value=\\"policy-kubed-eks\\" label=\\"Policy kubed-eks\\">\\n\\n```json\\n{\\n    \\"Version\\": \\"2012-10-17\\",\\n    \\"Statement\\": [\\n        {\\n            \\"Sid\\": \\"kubedEks\\",\\n            \\"Effect\\": \\"Allow\\",\\n            \\"Action\\": [\\n                \\"eks:ListClusters\\",\\n                \\"eks:DescribeCluster\\"\\n            ],\\n            \\"Resource\\": \\"*\\"\\n        }\\n    ]\\n}\\n```\\n\\n</TabItem>\\n</Tabs>\\n\\n#### `mc-project` aka kubed-follower\\n\\n<Tabs defaultValue=\\"hcl\\">\\n<TabItem value=\\"hcl\\" label=\\"Terraform\\">\\n\\n```hcl\\nlocals {\\n  mc_mgmt_id = \\"<mc-mgmt_id>\\"\\n}\\n\\ndata \\"aws_iam_policy_document\\" \\"kubed_follower_assume\\" {\\n  statement {\\n    sid    = \\"kubedFollowerAssume\\"\\n    effect = \\"Allow\\"\\n    principals {\\n      identifiers = toset([\\"arn:aws:iam::${local.mc_mgmt_id}:role/kubed-master\\"])\\n      type        = \\"AWS\\"\\n    }\\n    actions = [\\n      \\"sts:AssumeRole\\",\\n    ]\\n  }\\n}\\n\\ndata \\"aws_iam_policy_document\\" \\"kubed_follower\\" {\\n  statement {\\n    sid    = \\"kubedEks\\"\\n    effect = \\"Allow\\"\\n    actions = [\\n      \\"eks:DescribeCluster\\",\\n      \\"eks:ListClusters\\"\\n    ]\\n    resources = [\\"*\\"]\\n  }\\n}\\n\\n\\nresource \\"aws_iam_policy\\" \\"kubed_follower\\" {\\n  name   = \\"kubed-follower\\"\\n  policy = data.aws_iam_policy_document.kubed_follower.json\\n}\\n\\n\\nresource \\"aws_iam_role\\" \\"kubed_follower\\" {\\n  name                = \\"kubed-follower\\"\\n  description         = \\"IAM role which allows kubed sync secrets from mc-mgmt to this account\\"\\n  assume_role_policy  = data.aws_iam_policy_document.kubed_follower_assume.json\\n  managed_policy_arns = [aws_iam_policy.kubed_follower.arn]\\n}\\n```\\n\\n</TabItem>\\n<TabItem value=\\"trust\\" label=\\"Trust policy\\">\\n\\n```json\\n{\\n    \\"Version\\": \\"2012-10-17\\",\\n    \\"Statement\\": [\\n        {\\n            \\"Sid\\": \\"kubedFollowerAssume\\",\\n            \\"Effect\\": \\"Allow\\",\\n            \\"Principal\\": {\\n                \\"AWS\\": \\"arn:aws:iam:::<mc-mgmt_id>:role/kubed-master\\"\\n            },\\n            \\"Action\\": \\"sts:AssumeRole\\"\\n        }\\n    ]\\n}\\n```\\n\\n</TabItem>\\n<TabItem value=\\"iam-policy\\" label=\\"Policy kubed-eks\\">\\n\\n```json\\n{\\n    \\"Statement\\": [\\n        {\\n            \\"Action\\": [\\n                \\"eks:ListClusters\\",\\n                \\"eks:DescribeCluster\\"\\n            ],\\n            \\"Effect\\": \\"Allow\\",\\n            \\"Resource\\": \\"*\\",\\n            \\"Sid\\": \\"kubedEks\\"\\n        }\\n    ],\\n    \\"Version\\": \\"2012-10-17\\"\\n}\\n```\\n\\n</TabItem>\\n</Tabs>\\n\\n#### ServiceAccount kubed\\n\\n\u041d\u0430 **ServiceAccount** kubed-master \u043d\u0443\u0436\u043d\u043e \u043f\u043e\u0432\u0435\u0441\u0438\u0442\u044c \u0430\u043d\u043d\u043e\u0442\u0430\u0446\u0438\u044e:\\n\\n```yaml\\nannotations:\\n  eks.amazonaws.com/role-arn: arn:aws:iam::<mc-mgmt_id>:role/kubed-master\\n```\\n\\n#### ConfgiMap aws-auth\\n\\n<Tabs defaultValue=\\"kubed-master\\">\\n<TabItem value=\\"kubed-master\\" label=\\"kubed master\\">\\n\\n```yaml\\napiVersion: v1\\nkind: ConfigMap\\nmetadata:\\n  name: aws-auth\\n  namespace: kube-system\\ndata:\\n  mapRoles: |\\n    - \\"groups\\":\\n      - \\"system:masters\\"\\n      \\"rolearn\\": \\"arn:aws:iam::<mc-mgmt_id>:role/kubed-master\\"\\n      \\"username\\": \\"\\"\\n      ...\\n```\\n\\n</TabItem>\\n<TabItem value=\\"kubed-follower\\" label=\\"kubed follower\\">\\n\\n```yaml\\napiVersion: v1\\nkind: ConfigMap\\nmetadata:\\n  name: aws-auth\\n  namespace: kube-system\\ndata:\\n  mapRoles: |\\n    - \\"groups\\":\\n      - \\"system:masters\\"\\n      \\"rolearn\\": \\"arn:aws:iam::<mc-project_id>:role/kubed-follower\\"\\n      \\"username\\": \\"\\"\\n      ...\\n```\\n\\n\\n</TabItem>\\n</Tabs>\\n\\n### Docker image\\n\\n\u041e\u0431\u0440\u0430\u0437 \u043e\u0442 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u043e\u0432 scratch, \u0432 \u043d\u0435\u043c \u0435\u0441\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0431\u0438\u043d\u0430\u0440\u043d\u0438\u043a kubed, \u043d\u0430\u043c \u0436\u0435 \u043d\u0443\u0436\u043d\u044b \u0443\u0442\u0438\u043b\u0438\u0442\u044b aws \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f kubeconfig.\\n\\n```Dockerfile\\nFROM appscode/kubed:v0.13.2 as downloader\\n\\nFROM alpine:3.17\\n\\nCOPY --from=downloader /kubed /usr/bin/kubed\\n\\nRUN apk add --no-cache \\\\\\n  curl~=7.86 \\\\\\n  py3-pip~=22.3 \\\\\\n  && pip install --no-cache-dir \\\\\\n  awscli~=1.27 \\\\\\n  && curl -Lo aws-iam-authenticator https://github.com/kubernetes-sigs/aws-iam-authenticator/releases/download/v0.5.9/aws-iam-authenticator_0.5.9_linux_amd64 \\\\\\n  && chmod +x aws-iam-authenticator \\\\\\n  && mv aws-iam-authenticator /usr/bin/\\n\\nRUN addgroup --gid 1950 app \\\\\\n  && addgroup --gid 1000 app \\\\\\n  && adduser \\\\\\n  --uid 1000 \\\\\\n  --home /home/app \\\\\\n  --shell /bin/ash \\\\\\n  --ingroup app \\\\\\n  --disabled-password \\\\\\n  app \\\\\\n  && addgroup app app\\n\\nUSER 1000\\nWORKDIR /home/app\\n\\nENTRYPOINT [\\"/usr/bin/kubed\\"]\\n```\\n\\n### K8s controller\\n\\n\u0412 mc-mgmt \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435 \u0442\u0430\u043a \u0436\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043e\u0431\u044b\u0447\u043d\u044b\u0439 \u0438\u043d\u0442\u0430\u043d\u0441 kubed-\u0430, \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0439 [helm \u0447\u0430\u0440\u0442\u043e\u043c](https://github.com/kubeops/config-syncer/tree/master/charts/kubed), \u0438\u0437 \u043d\u0435\u0433\u043e \u043c\u044b \u0438 \u0431\u0435\u0440\u0435\u043c \u0432\u0441\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0435 k8s RBAC-\u0438.\\n\\n:::danger\\n\\n\u042d\u0442\u043e\u0442 \u0441\u043f\u043e\u0441\u043e\u0431 **\u0434\u0435\u0441\u0442\u0440\u0443\u043a\u0442\u0438\u0432\u0435\u043d**, \u043d\u0435\u0432\u0435\u0440\u043d\u0430\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f kubed-master \u043c\u043e\u0436\u0435\u0442 \u0440\u0435\u0432\u0435\u0440\u0441\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044e \u0441\u0435\u043a\u0440\u0435\u0442\u043e\u0432 \u043c\u0435\u0436\u0434\u0443 namespace-\u0430\u043c\u0438. \u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u044f \u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439 \u043a\u043b\u0430\u0441\u0442\u0435\u0440 \u0434\u043b\u044f kubed-master\\n\\n:::\\n\\n<Tabs defaultValue=\\"cm\\">\\n<TabItem value=\\"cm\\" label=\\"ConfigMap\\">\\n\\n```yaml\\n---\\napiVersion: v1\\nkind: ConfigMap\\nmetadata:\\n  name: kubed-master-aws\\n  namespace: kube-system\\ndata:\\n  credentials: |-\\n    [mc-mgmt]\\n    role_arn = arn:aws:iam::<mc-mgmt_id>:role/kubed-master\\n    web_identity_token_file = /var/run/secrets/eks.amazonaws.com/serviceaccount/token\\n    [mc-project]\\n    role_arn = arn:aws:iam::<mc-project_id>:role/kubed-follower\\n    source_profile = mc-mgmt\\n    role_session_name = mc-project\\n  generate-kubeconfig.sh: |-\\n    #!/bin/bash\\n    set -eux\\n\\n    aws eks update-kubeconfig --name mc-project-k8s --alias mc-project-k8s --profile mc-project\\n\\n    # NOTE: mc-mgmt-k8s should the last due to current-context\\n    aws eks update-kubeconfig --name mc-mgmt-k8s --alias mc-mgmt-k8s --profile mc-mgmt\\n```\\n\\n</TabItem>\\n\\n<TabItem value=\\"deploy\\" label=\\"Deployment\\">\\n\\n```yaml\\n---\\n\\napiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: kubed-master\\n  namespace: kube-system\\n  labels:\\n    app.kubernetes.io/name: kubed-master\\n    app.kubernetes.io/instance: kubed-master\\n    app.kubernetes.io/version: \\"v0.13.2\\"\\nspec:\\n  replicas: 1\\n  selector:\\n    matchLabels:\\n      app.kubernetes.io/name: kubed-master\\n      app.kubernetes.io/instance: kubed-master\\n  template:\\n    metadata:\\n      labels:\\n        app.kubernetes.io/name: kubed-master\\n        app.kubernetes.io/instance: kubed-master\\n    spec:\\n      serviceAccountName: kubed\\n      # NOTE: kubeconfig-generator\\n      initContainers:\\n        - name: kubeconfig-generator\\n          image: docker.io/my-company/kubed:v0.13.2\\n          volumeMounts:\\n            - name: kubeconfig\\n              mountPath: /srv/kubed\\n            - name: aws-config\\n              mountPath: /home/app/.aws\\n            - name: kubed-master-aws\\n              mountPath: /home/app/scripts\\n          command:\\n            - sh\\n            - -c\\n            - |\\n              mkdir -p /home/app/.aws &&\\n              cp /home/app/scripts/credentials /home/app/.aws &&\\n              sh /home/app/scripts/generate-kubeconfig.sh &&\\n              cp /home/app/.kube/config /srv/kubed/kubeconfig\\n\\n      containers:\\n        - name: kubed-master\\n          image: docker.io/my-company/kubed:v0.13.2\\n          args:\\n            - run\\n            - --v=3\\n            - --secure-port=8443\\n            - --audit-log-path=-\\n            - --tls-cert-file=/var/serving-cert/tls.crt\\n            - --tls-private-key-file=/var/serving-cert/tls.key\\n            - --use-kubeapiserver-fqdn-for-aks=true\\n            - --enable-analytics=false\\n            - --cluster-name=mc-mgmt\\n            - --kubeconfig-file=/srv/kubed/kubeconfig\\n            - --config-source-namespace=prod\\n          ports:\\n            - containerPort: 8443\\n          resources: {}\\n          volumeMounts:\\n            - name: kubeconfig\\n              mountPath: /srv/kubed\\n            - name: aws-config\\n              mountPath: /home/app/.aws\\n            - name: scratch\\n              mountPath: /tmp\\n            - name: serving-cert\\n              mountPath: /var/serving-cert\\n      volumes:\\n        # NOTE: we\'d like to generate kubeconfig during initContainer\\n        - name: kubeconfig\\n          emptyDir: {}\\n          # secret:\\n          #   secretName: kubed # NOTE: contains data.kubeconfig\\n        - name: aws-config\\n          emptyDir: {}\\n        - name: kubed-master-aws\\n          configMap:\\n            name: kubed-master-aws\\n            defaultMode: 0550\\n        - name: scratch\\n          emptyDir: {}\\n        - name: serving-cert\\n          secret:\\n            defaultMode: 420\\n            secretName: kubed-apiserver-cert\\n      securityContext:\\n        fsGroup: 1000\\n```\\n\\n</TabItem>\\n</Tabs>\\n\\n\\n\\n## \u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0439\\n\\n```yaml\\n---\\n\\napiVersion: v1\\nkind: ConfigMap\\nmetadata:\\n  name: cross-acc-sync-demo\\n  namespace: prod\\n  annotations:\\n    kubed.appscode.com/sync-contexts: \\"mc-project-k8s\\"\\ndata:\\n  foo: bar\\n  spam: eggs\\n```\\n\\n## \u041d\u044e\u0430\u043d\u0441\u044b \u0440\u0430\u0431\u043e\u0442\u044b\\n\\n:::info\\n\\n\u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f: \u044d\u0442\u043e ConfigMap, Secret\\n\\n:::\\n\\n- \u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437 namespace-\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0432\u043e \u0444\u043b\u0430\u0433\u0430\u0445 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0430 \u0432 namespace \u0441 \u0442\u0430\u043a\u0438\u043c \u0436\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435\u043c \u0432 follower \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430\u0445. \u041f\u0440\u0438 \u044d\u0442\u043e annotations \u0438 labels \u043d\u0430 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f\u0445 \u0432 follower \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430\u0445 \u043d\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442\u0441\u044f.\\n- \u041f\u043e\u0432\u043e\u0434\u043e\u043c \u0434\u043b\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0439 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f: \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a pod-\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0430, \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 `.data` \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438. \u0422.\u0435. \u0435\u0441\u043b\u0438 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0431\u0443\u0434\u0435\u0442 \u0443\u0434\u0430\u043b\u0435\u043d\u0430 \u0432 follower \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435, \u043e\u043d\u0430 \u043d\u0435 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0443\u0435\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u043e\u043c.\\n- \u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0432 master \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0435, \u0443\u0434\u0430\u043b\u0438\u0442 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u0432\u043e \u0432\u0441\u0435\u0445 follower-\u0430\u0445.\\n- \u0412 \u0441\u043b\u0443\u0447\u0430\u0435, \u0435\u0441\u043b\u0438 \u0432 follower \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435 \u0435\u0441\u0442\u044c \u0441\u0432\u043e\u0439 kubed \u0434\u043b\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u0435\u0436\u0434\u0443 namespace-\u0430\u043c\u0438, \u0442\u043e \u043c\u043e\u0436\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c annotation-\u0438\u044e \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u0438 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0440\u0430\u0437\u0431\u0435\u0436\u0438\u0442\u0441\u044f \u043f\u043e namespace-\u0430\u043c. \u041f\u0440\u0438\u0447\u0435\u043c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 `.data` \u0432 master \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u0441\u0435\u043a\u0440\u0435\u0442 \u0432 follower, \u043d\u043e \u043d\u0435 \u043f\u0435\u0440\u0435\u0442\u0440\u0435\u0442 \u044d\u0442\u0443 \u0430\u043d\u043d\u043e\u0442\u0430\u0446\u0438\u044e.\\n\\n\u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0430\u043d\u043d\u043e\u0442\u0430\u0446\u0438\u044e \u0432 follower \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435\\n```shell\\nkubectl --context mc-project annotate cm cross-acc-sync-demo \\"kubed.appscode.com/sync=sync/kubed-master=true\\"\\n```\\n\\n\u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c label \u043d\u0430 \u0434\u0440\u0443\u0433\u043e\u0439 namespace \u0432 follower \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435, \u0447\u0442\u043e\u0431\u044b \u043c\u0435\u0441\u0442\u043d\u044b\u0439 kubed \u0437\u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043b cm \u043c\u0435\u0436\u0434\u0443 namespace-\u0430\u043c\u0438.\\n\\n```yaml\\n---\\n\\nkind: Namespace\\napiVersion: v1\\nmetadata:\\n  name: env-ahorbach\\n  labels:\\n    name: env-ahorbach\\n    sync/kubed-master: \\"true\\"\\n```\\n\\n## \u0421\u0441\u044b\u043b\u043a\u0438\\n\\n- [Imran Hayder: Adding cross-account access to EKS](https://dev.to/hayderimran7/adding-cross-account-access-to-eks-5ebh)\\n- [AWS: Enabling cross-account access to Amazon EKS cluster resources](https://aws.amazon.com/blogs/containers/enabling-cross-account-access-to-amazon-eks-cluster-resources/)\\n- [kubed: Synchronize Configuration across Clusters](https://appscode.com/products/kubed/v0.12.0/guides/config-syncer/inter-cluster/)\\n- [jdepp: KS cross-cluster and cross-namespace syncing issue.](https://github.com/kubeops/config-syncer/issues/457)"},{"id":"lens-build","metadata":{"permalink":"/Andrew-Horbach.github.io-Public/blog/lens-build","editUrl":"https://github.com/karma-git/Andrew-Horbach.github.io-Public/blob/master/blog/2022-11-20-lens-build.md","source":"@site/blog/2022-11-20-lens-build.md","title":"Lens - build from source","description":"Notion Fast Start","date":"2022-11-20T00:00:00.000Z","formattedDate":"November 20, 2022","tags":[{"label":"k8s","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/k-8-s"},{"label":"nodejs","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/nodejs"}],"readingTime":0.715,"truncated":false,"authors":[{"name":"Andrew Horbach","url":"https://github.com/karma-git","imageURL":"https://github.com/karma-git.png","key":"a.horbach"}],"prevItem":{"title":"Kubed - secret sync between k8s clusters in different aws accounts","permalink":"/Andrew-Horbach.github.io-Public/blog/kubed-cross-sync"},"nextItem":{"title":"Notion","permalink":"/Andrew-Horbach.github.io-Public/blog/notion-crush-course"}},"content":"## \u0418\u0441\u0442\u043e\u0440\u0438\u044f\\n\\n\u041d\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u043b\u0441\u044f Lens 6, \u0431\u044b\u0441\u0442\u0440\u043e \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0443 \u0440\u0435\u0448\u0438\u0442\u044c \u043d\u0435 \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u043e\u0441\u044c, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u0440\u0435\u0448\u0438\u043b \u043e\u0442\u043a\u0430\u0442\u0438\u0442\u044c\u0441\u044f \u043d\u0430 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0435 \u0432\u0435\u0440\u0441\u0438\u0438.\\n\\n```shell\\nDEBUG=true /Applications/Lens.app/Contents/MacOS/Lens\\n```\\n\u041b\u043e\u0433\u0438 \u0434\u0435\u0431\u0430\u0433\u0430 \u0432\u044b\u0434\u0430\u0432\u0430\u043b\u0438 \u043e\u0448\u0438\u0431\u043a\u0438, \u043f\u043e \u043a\u043e\u0442\u043e\u0440\u044b\u043c \u0432 issues \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438 \u043d\u0430 GitHub https://github.com/lensapp/lens \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043d\u0430\u0439\u0442\u0438 \u043f\u043e\u043b\u0435\u0437\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438.\\n\\n\u041a\u0430\u043a \u0432\u044b\u044f\u0441\u043d\u0438\u043b\u043e\u0441\u044c - \u043b\u0435\u0433\u043a\u043e\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u043c \u0440\u0435\u043b\u0438\u0437\u0430\u043c \u043d\u0435\u0442, \u0435\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u0438\u0437 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432 \u044d\u0442\u043e \u0441\u043e\u0431\u0440\u0430\u0442\u044c\u0441\u044f \u0438\u0437 \u0441\u043e\u0440\u0446\u043e\u0432.\\n\\n## \u0421\u0431\u043e\u0440\u043a\u0430\\n\\n```shell\\n$ git clone https://github.com/lensapp/lens.git\\n$ git checkout v5.5.4 # \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u0438\u0437 \u0441\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u044b\u0445 \u0440\u0435\u043b\u0438\u0437\u043e\u0432 5.x.x\\n$ make build\\n```\\n\u0422\u0443\u0442 \u0438 \u043d\u0430\u0447\u0438\u043d\u0430\u044e\u0442\u0441\u044f \u0433\u0440\u0430\u0431\u043b\u0438, \u0432 \u0431\u043e\u043b\u044c\u0448\u0435\u0439 \u0441\u0442\u0435\u043f\u0435\u043d\u0438 \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u0441 nodejs \u0438 \u043d\u0435\u0441\u043e\u0432\u043c\u0435\u0441\u0442\u0438\u043c\u043e\u0441\u0442\u044c\u044e \u0432\u0435\u0440\u0441\u0438\u0439 \u0441\u0430\u043c\u043e\u0439 \u043d\u043e\u0434\u044b \u0438\u043b\u0438 \u043f\u0430\u043a\u0435\u0442\u043e\u0432.\\n\\n\u041c\u043d\u0435 \u0434\u043b\u044f \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u043a\u0438 \u0432\u0435\u0440\u0441\u0438\u0438 \u043f\u043e\u043c\u043e\u0433\u043b\u0430 \u0443\u0442\u0438\u043b\u0438\u0442\u0430 `nvm` \u0438 \u044d\u0442\u0430 [\u0441\u0442\u0430\u0442\u044c\u044f](https://tecadmin.net/install-nvm-macos-with-homebrew/)\\n\\n```shell\\nnvm ls-remote  # \u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043a\u0430\u043a\u0438\u0435 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u043d\u0430\u043c \u043c\u043e\u0436\u0435\u0442 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0438\u0442\u044c \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440 \u043d\u043e\u0434\u044b\\nnvm install lts/fermium # node 15.x\\nnvm use lts/fermium  # \u043f\u0438\u043d\u0438\u043c \u0432\u0435\u0440\u0441\u0438\u044e \u043d\u043e\u0434\u044b \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435\\n```\\n\\n\u0412 \u043c\u043e\u0435\u043c \u0441\u043b\u0443\u0447\u0430\u0435 \u043f\u0438\u043d\u0430 \u0432\u0435\u0440\u0441\u0438\u0438 \u043d\u043e\u0434\u044b \u0445\u0432\u0430\u0442\u0438\u043b\u043e, \u0447\u0442\u043e\u0431\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u043e\u0431\u0440\u0430\u0442\u044c `.dmg` \u043f\u0430\u043a\u0435\u0442."},{"id":"notion-crush-course","metadata":{"permalink":"/Andrew-Horbach.github.io-Public/blog/notion-crush-course","editUrl":"https://github.com/karma-git/Andrew-Horbach.github.io-Public/blob/master/blog/2022-03-08-notion.md","source":"@site/blog/2022-03-08-notion.md","title":"Notion","description":"Notion Fast Start","date":"2022-03-08T00:00:00.000Z","formattedDate":"March 8, 2022","tags":[{"label":"docops","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/docops"},{"label":"notion","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/notion"},{"label":"productivity","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/productivity"}],"readingTime":0.465,"truncated":false,"authors":[{"name":"Andrew Horbach","url":"https://github.com/karma-git","imageURL":"https://github.com/karma-git.png","key":"a.horbach"}],"prevItem":{"title":"Lens - build from source","permalink":"/Andrew-Horbach.github.io-Public/blog/lens-build"},"nextItem":{"title":"GoodNotes - Prometheus","permalink":"/Andrew-Horbach.github.io-Public/blog/goodnotes-prometheus"}},"content":"## Long Story Short\\n\\n\u0423\u0436\u0435 \u043f\u0430\u0440\u0443 \u043c\u0435\u0441\u044f\u0446\u0435\u0432 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e `Notion` \u0434\u043b\u044f \u0437\u0430\u043c\u0435\u0442\u043e\u043a, \u043d\u043e \u0434\u0435\u043b\u0430\u043b \u0432\u0441\u0435 \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0442\u043e\u043f\u043e\u0440\u043d\u043e. \u0423 \u043c\u0435\u043d\u044f \u0431\u044b\u043b\u043e \u043c\u043d\u043e\u0433\u043e \u0441\u0442\u0440\u0430\u043d\u0438\u0447\u0435\u043a \u0434\u0440\u0435\u0432\u043e\u0432\u0438\u0434\u043d\u043e\u0439 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b \u0438 \u043a\u0430\u043d\u0431\u0430\u043d \u0434\u043e\u0441\u043a\u0430 \u0441 \u0442\u0430\u0441\u043a\u0430\u043c\u0438 \u043d\u0430 \u043d\u0435\u0434\u0435\u043b\u044e. \u041f\u0440\u0430\u0432\u0434\u0430 \u043d\u0435\u0434\u0430\u0432\u043d\u043e \u0432\u0437\u0433\u043b\u044f\u043d\u0443\u043b \u0432 \u0442\u0435\u043c\u043f\u043b\u0435\u0439\u0442\u044b \u043e\u0442 \u0441\u0430\u043c\u043e\u0433\u043e `Notin`-\u0430 \u0438 \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043b \u043e\u0442\u0442\u0443\u0434\u0430 *engineering page* (\u043d\u0438\u0436\u0435 \u043f\u0440\u0438\u043c\u0435\u0440 \u043f\u043e\u0434 \u0441\u043f\u043e\u0439\u043b\u0435\u0440\u043e\u043c).\\n\\n:::info\\n\\n<details>\\n<summary>\u043c\u043e\u0439 \u043a\u0430\u043d\u0431\u0430\u043d \u0431\u043e\u0440\u0434</summary>\\n\\n![img](https://ah-public-pictures.hb.bizmrg.com/it-happens/Screenshot%202022-03-08%20at%2014.00.48.png)\\n\\n</details>\\n\\n:::\\n\\n\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u043b \u0432\u0438\u0434\u0435\u043e \u0412\u043b\u0430\u0434\u043b\u0435\u043d\u0430, \u043d\u0430\u0448\u0435\u043b \u043c\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u0435\u0437\u043d\u043e\u0433\u043e (\u043d\u0438\u0436\u0435 \u0431\u0443\u0434\u0435\u0442 pdf \u0441 \u043a\u043e\u043d\u0441\u043f\u0435\u043a\u0442\u043e\u043c)\\n\\n<div class=\\"video-wrapper\\">\\n  <iframe  height=\\"540\\" frameborder=\\"0\\" allowfullscreen width=\\"100%\\" src=\\"https://www.youtube.com/embed/JbJducQmxqw\\" frameborder=\\"0\\" allowfullscreen></iframe>\\n</div>\\n\\n**\u041a\u043e\u043d\u0441\u043f\u0435\u043a\u0442**:\\n\\n[\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0444\u0430\u0439\u043b](https://ah-public-pictures.hb.bizmrg.com/it-happens/notion-video.pdf)\\n\\n\x3c!-- FIXME: use pdf.js? https://github.com/mozilla/pdf.js#online-demo --\x3e\\n\\n<embed src=\\"https://ah-public-pictures.hb.bizmrg.com/it-happens/notion-video.pdf\\" type=\\"application/pdf\\" width=\\"100%\\" height=\\"600px\\" />"},{"id":"goodnotes-prometheus","metadata":{"permalink":"/Andrew-Horbach.github.io-Public/blog/goodnotes-prometheus","editUrl":"https://github.com/karma-git/Andrew-Horbach.github.io-Public/blob/master/blog/2022-03-06-goodnotes-prom.md","source":"@site/blog/2022-03-06-goodnotes-prom.md","title":"GoodNotes - Prometheus","description":"\u0437\u0430\u043c\u0435\u0442\u043a\u0438 \u043d\u0430 iPad, Prometheus","date":"2022-03-06T00:00:00.000Z","formattedDate":"March 6, 2022","tags":[{"label":"docops","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/docops"},{"label":"ipad","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/ipad"},{"label":"productivity","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/productivity"},{"label":"observability","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/observability"},{"label":"monitoring","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/monitoring"},{"label":"prometheus","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/prometheus"}],"readingTime":1.005,"truncated":false,"authors":[{"name":"Andrew Horbach","url":"https://github.com/karma-git","imageURL":"https://github.com/karma-git.png","key":"a.horbach"}],"prevItem":{"title":"Notion","permalink":"/Andrew-Horbach.github.io-Public/blog/notion-crush-course"},"nextItem":{"title":"Selfmade Vagrant box","permalink":"/Andrew-Horbach.github.io-Public/blog/selfmade-vagrant-box"}},"content":"## iPad. Long Story Short\\n\\n\u041e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043d\u0435\u0434\u0430\u0432\u043d\u043e \u0437\u0430\u0438\u043c\u0435\u043b iPad + Pencil + [Logitech Combo Touch](https://www.logitech.com/ru-ru/products/ipad-keyboards/combo-touch.html) \u0434\u043b\u044f \u0440\u0438\u0441\u043e\u0432\u0430\u043d\u0438\u044f \u0440\u0438\u0441\u0443\u043d\u043a\u043e\u0432, \u0437\u0430\u043c\u0435\u0442\u043e\u043a \u0438 \u043a\u043e\u043d\u0441\u043f\u0435\u043a\u0442\u043e\u0432, \u043b\u0435\u0433\u043a\u043e\u0432\u0435\u0441\u043d\u043e\u0439 \u0437\u0430\u043c\u0435\u043d\u0435 \u043d\u043e\u0443\u0442\u0430 \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u0438\u043d\u0446\u0438\u0434\u0435\u043d\u0442\u043e\u0432.\\n- \u0440\u0438\u0441\u043e\u0432\u0430\u043d\u0438\u0435 -> \u043a\u0443\u043b \u0441 [procreate](https://apps.apple.com/us/app/procreate/id425073498)\\n- \u0437\u0430\u043c\u0435\u0442\u043a\u0438 / \u043a\u043e\u043d\u0441\u043f\u0435\u043a\u0442 -> \u043d\u0440\u0430\u0432\u0438\u0442\u044c\u0441\u044f \u0441 [goodnotes](https://www.goodnotes.com/)\\n- \u0437\u0430\u043c\u0435\u043d\u0430 \u043d\u043e\u0443\u0442\u0430 -> \u0432 Logitech \u043e\u0442\u0432\u0440\u0430\u0442\u043d\u044b\u0439 \u043a\u043b\u0438\u043a \u043d\u0430 \u0442\u0430\u0447 \u0438 \u043a\u0443\u0447\u0430 \u043f\u0440\u043e\u0431\u043b\u0435\u043c \u0441\u0430\u043c\u043e\u0433\u043e iPad. \u041d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043f\u0440\u043e\u0435\u043a\u0442 [code-server](https://github.com/coder/code-server) - \u044f \u043c\u043e\u0433\u0443 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0437\u0430 iPad. \u041e\u0434\u043d\u0430\u043a\u043e \u0441\u0447\u0438\u0442\u0430\u044e, \u0447\u0442\u043e \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043f\u0443\u043d\u043a\u0442\u0443 \u0441\u043a\u043e\u0440\u0435\u0435 \u043d\u0435\u0443\u0434.\\n\\n## GoodNotes\\n\\n\u0421\u043e\u0444\u0442\u0438\u043d\u0430 \u043a\u0430\u043a \u0431\u044b \u043f\u0440\u0438\u043c\u0438\u0442\u0438\u0432\u043d\u0430\u044f, \u043d\u043e \u043c\u043e\u0436\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c \u0432\u043e\u0442 \u0442\u0430\u043a\u0438\u0435 \u043a\u043e\u043d\u0441\u043f\u0435\u043a\u0442\u044b *from scratch*\\n\\n![img](https://ah-public-pictures.hb.bizmrg.com/sre/goodnotes-prom.jpg)\\n\\n\u041b\u0438\u0431\u043e \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0442\u044c \u0432 \u044d\u0442\u0443 \u0441\u043e\u0444\u0442\u0438\u043d\u0443 `PDF`-\u044b \u0438 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0443\u0436\u0435 \u0438\u0445:\\n\\n![img](https://ah-public-pictures.hb.bizmrg.com/sre/goodnotes-gounited.jpg)\\n\\n:::note\\n\\n:pencil2: \u041c\u043d\u0435 \u0441\u043b\u043e\u0436\u043d\u043e \u044d\u0442\u043e \u043e\u0431\u044a\u044f\u0441\u043d\u0438\u0442\u044c, \u043d\u043e \u0435\u0441\u0442\u044c \u0447\u0442\u043e-\u0442\u043e \u0442\u0430\u043a\u0442\u0438\u043b\u044c\u043d\u043e \u043f\u0440\u0438\u044f\u0442\u043d\u043e\u0435 \u0432 \u0442\u043e\u043c, \u0447\u0442\u043e\u0431\u044b \u043f\u0438\u0441\u0430\u0442\u044c \u0447\u0442\u043e-\u0442\u043e \u043e\u0442 \u0440\u0443\u043a\u0438, \u043f\u0440\u0438 \u044d\u0442\u043e\u043c \u043a\u043e\u043d\u0441\u043f\u0435\u043a\u0442 \u043d\u0435 \u043f\u0440\u0435\u0432\u0440\u0430\u0442\u0438\u0442\u044c\u0441\u044f \u0432 \u043c\u0443\u0441\u043e\u0440.\\n\\n\u0425\u043e\u0447\u0435\u0442\u0441\u044f \u0441\u043d\u043e\u0432\u0430 \u043f\u043e\u0439\u0442\u0438 \u0432 \u0443\u043d\u0438\u0432\u0435\u0440 :books:\\n:::\\n\\n## Links\\n\\n- [How to create good-looking notes on the iPad](https://medium.goodnotes.com/how-to-create-good-looking-notes-on-the-ipad-50289cb37d90)\\n- [How to Mark Up a PDF on the iPad](https://medium.goodnotes.com/how-to-markup-pdf-ipad-dc6b25c144bb)\\n\\n**TechWorld with Nana** about prometheus:\\n- [How Prometheus Monitoring works | Prometheus Architecture explained](https://www.youtube.com/watch?v=h4Sl21AKiDg)\\n- [Setup Prometheus Monitoring on Kubernetes using Helm and Prometheus Operator | Part 1](https://www.youtube.com/watch?v=QoDqxm7ybLc)\\n- [Prometheus Monitoring - Steps to monitor third-party apps using Prometheus Exporter | Part 2](https://www.youtube.com/watch?v=mLPg49b33sA)\\n\\n**Go United**\\n- [Article](https://karma-git.github.io/Andrew-Horbach.github.io-Public/docs/ProgrammingLanguages/go/go-init)\\n- [Repo](https://github.com/karma-git/epam-golang-united)"},{"id":"selfmade-vagrant-box","metadata":{"permalink":"/Andrew-Horbach.github.io-Public/blog/selfmade-vagrant-box","editUrl":"https://github.com/karma-git/Andrew-Horbach.github.io-Public/blob/master/blog/2022-01-28-self-vagrant-box.md","source":"@site/blog/2022-01-28-self-vagrant-box.md","title":"Selfmade Vagrant box","description":"VagrantBox \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u0442\u0441\u044f \u043d\u0430\u0441\u0442\u043e\u043b\u044c\u043a\u043e \u0436\u0435 \u043f\u0440\u043e\u0441\u0442\u043e \u043a\u0430\u043a \u0438 DockerImage!","date":"2022-01-28T00:00:00.000Z","formattedDate":"January 28, 2022","tags":[{"label":"vagrant","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/vagrant"},{"label":"packer","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/packer"},{"label":"ansible","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/ansible"}],"readingTime":1.75,"truncated":true,"authors":[{"name":"Andrew Horbach","url":"https://github.com/karma-git","imageURL":"https://github.com/karma-git.png","key":"a.horbach"}],"prevItem":{"title":"GoodNotes - Prometheus","permalink":"/Andrew-Horbach.github.io-Public/blog/goodnotes-prometheus"},"nextItem":{"title":"CKA","permalink":"/Andrew-Horbach.github.io-Public/blog/cka-commitment"}},"content":"\x3c!-- import tabs --\x3e\\nimport Tabs from \'@theme/Tabs\';\\nimport TabItem from \'@theme/TabItem\';\\n\\n\u041d\u0430 VagrantCloud \u043d\u0435 \u043d\u0430\u0448\u0435\u043b \u043d\u043e\u0440\u043c\u0430\u043b\u044c\u043d\u044b\u0445 box-\u043e\u0432 \u0441 GUI.\\n\\n## \u041f\u0440\u043e\u0446\u0435\u0441\u0441\\n\\n:::info\\n\u0411\u0443\u0434\u0443 \u0434\u0435\u043b\u0430\u0442\u044c \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0438 \u0441 _docker_\\n:::\\n\\n### config file\\n\\n\u041e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u043c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u043d\u0430\u0448\u0435\u0433\u043e VagrantBox (_DockerImage_) \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 `.hcl` (_terraform_)\\n\\n```hcl\\nsource \\"vagrant\\" \\"ubuntu\\" {\\n  add_force    = true\\n  communicator = \\"ssh\\"\\n  provider     = \\"virtualbox\\"\\n  source_path  = \\"ubuntu/focal64\\"\\n}\\n\\nbuild {\\n  name    = \\"learn-packer\\"\\n  sources = [\\n    \\"source.vagrant.ubuntu\\"\\n  ]\\n}\\n```\\n\\n:::tip\\n\u041f\u043e\u043b\u0435\u0437\u043d\u044b\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u044b:\\n```shell\\npacker validate packer.hcl  # \u0432\u0430\u043b\u0438\u0434\u0438\u0440\u0443\u0435\u0442 \u0444\u0430\u0439\u043b\\npacker fmt .                # \u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u0443\u0435\u0442 \u0444\u0430\u0439\u043b\u044b, \u0438 \u043a\u0430\u0436\u0435\u0442\u0441\u044f, \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044e\\n```\\n:::\\n\\n### build\\n\\n\u0421 \u043f\u043e\u043c\u043e\u0449\u044c\u044e [`packer`](https://www.packer.io/) (_docker engine_) \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u043c \u043e\u0431\u0440\u0430\u0437.\\n\\n```shell\\npacker build packer.hcl\\n```\\n\\n\u0427\u0435\u0440\u0435\u0437 \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0432\u0440\u0435\u043c\u044f \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 `learn-packer` \u043f\u043e\u044f\u0432\u0438\u0442\u0441\u044f \u0444\u0430\u0439\u043b `.box` (_docker_image_)\\n\\n### push\\n\\n\u0417\u0430\u043b\u0438\u0432\u0430\u0435\u043c \u043f\u043e\u043b\u0443\u0447\u0438\u0432\u0448\u0438\u0439\u0441\u044f \u0444\u0430\u0439\u043b \u043d\u0430 [VagrantCloud](https://app.vagrantup.com/boxes/search). \u041f\u043e\u043d\u0430\u0434\u043e\u0431\u0438\u0442\u044c\u0441\u044f \u0441\u043e\u0431\u0440\u0430\u0442\u044c \u0445\u044d\u0448-\u0441\u0443\u043c\u043c\u0443 \u0444\u0430\u0439\u043b\u0430, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u0447\u0435\u0440\u0435\u0437 `md5`\\n\\n### provisioner\\n\\n:::note\\n\u041b\u044e\u0431\u0438\u043c\u044b\u0439 \u043f\u0440\u043e\u0432\u0438\u0436\u0435\u043d\u0435\u0440 - ansible, \u043d\u043e \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c `shell`\\n:::\\n\\n<Tabs defaultValue=\\"hcl\\">\\n<TabItem value=\\"hcl\\" label=\\"packer.hcl\\">\\n\\n```hcl\\nsource \\"vagrant\\" \\"ubuntu\\" {\\n  add_force    = true\\n  communicator = \\"ssh\\"\\n  provider     = \\"virtualbox\\"\\n  source_path  = \\"ubuntu/focal64\\"\\n}\\n\\nbuild {\\n  name    = \\"learn-packer\\"\\n  sources = [\\n    \\"source.vagrant.ubuntu\\"\\n  ]\\n  provisioner \\"ansible\\" {\\n    playbook_file = \\"./ansible/packer-playbook.yml\\"\\n  }\\n}\\n```\\n\\n</TabItem>\\n<TabItem value=\\"yml\\" label=\\"packer-playbook.yml\\">\\n\\n``` yml\\n---\\n\\n- name: install docker engine ubuntu\\n  hosts: all\\n\\n  become: true\\n  become_method: sudo\\n\\n  tasks:\\n    - name: 1. Update the apt package index and install packages to allow apt to use a repository over HTTPS\\n      apt:\\n        name: \\n          - apt-transport-https\\n          - ca-certificates\\n          - curl\\n          - gnupg\\n          - lsb-release\\n          - python3-pip\\n          - awscli\\n        state: latest\\n        update_cache: true\\n\\n    - name: 2. Add Docker\u2019s official GPG key\\n      apt_key:\\n        url: https://download.docker.com/linux/ubuntu/gpg\\n        state: present\\n\\n    - name: 3. Add Docker Repository\\n      apt_repository:\\n        repo: deb https://download.docker.com/linux/ubuntu focal stable  # FIXME move to var\\n        state: present\\n\\n    - name: 4. Install docker engine\\n      apt:\\n        name: docker-ce\\n        state: latest\\n        update_cache: true\\n\\n    # Docker post-install steps for ubuntu\\n\\n    - name: 1. Make sure that group \\"docker\\" exists\\n      group:\\n        name: docker\\n        state: present\\n\\n    - name: 2. Add aws user to docker docker group\\n      user:\\n        name: ubuntu\\n        groups: docker\\n        append: true\\n```\\n\\n</TabItem>\\n</Tabs>\\n\\n### post-processors\\n\\n:::caution\\n\u041d\u0435 \u043f\u0440\u043e\u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043b\\n:::\\n\\n\u0428\u0442\u0443\u043a\u0438 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u044e\u0442\u0441\u044f \u043f\u043e\u0441\u043b\u0435 \u0441\u0431\u043e\u0440\u043a\u0438, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u043f\u0443\u0431\u043b\u0438\u043a\u0430\u0446\u0438\u044f \u0432 *VagrantCloud* (_docker push_)\\n\\n[GitHub repo](https://github.com/karma-git/playground/tree/master/environment/vagrant/ubuntu-gui)\\n\\n\x3c!--truncate--\x3e"},{"id":"cka-commitment","metadata":{"permalink":"/Andrew-Horbach.github.io-Public/blog/cka-commitment","editUrl":"https://github.com/karma-git/Andrew-Horbach.github.io-Public/blob/master/blog/2021-02-15-cka-commitment.md","source":"@site/blog/2021-02-15-cka-commitment.md","title":"CKA","description":"\u043d\u0430\u0447\u0430\u043b \u0433\u043e\u0442\u043e\u0432\u0438\u0442\u044c\u0441\u044f \u043a \u044d\u043a\u0437\u0430\u043c\u0435\u043d\u0443","date":"2021-02-15T00:00:00.000Z","formattedDate":"February 15, 2021","tags":[{"label":"vagrant","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/vagrant"},{"label":"linux","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/linux"},{"label":"docker","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/docker"},{"label":"devops","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/devops"},{"label":"k8s","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/k-8-s"},{"label":"kubernetes","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/kubernetes"}],"readingTime":1.78,"truncated":true,"authors":[{"name":"Andrew Horbach","url":"https://github.com/karma-git","imageURL":"https://github.com/karma-git.png","key":"a.horbach"}],"prevItem":{"title":"Selfmade Vagrant box","permalink":"/Andrew-Horbach.github.io-Public/blog/selfmade-vagrant-box"},"nextItem":{"title":"Vagrant - DevOps Environment","permalink":"/Andrew-Horbach.github.io-Public/blog/vagrant-karma-linux"}},"content":"\u0411\u0443\u0434\u0443 \u043a\u0440\u0430\u0442\u043e\u043a, \u0443 \u0432\u0430\u0441 \u043c\u0430\u043b\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438: Certified Kubernetes Administrator [(CKA)](https://www.cncf.io/certification/cka/) \u043e\u0434\u0438\u043d \u0438\u0437 \u043a\u0440\u0443\u0442\u0435\u0439\u0448\u0438\u0445 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432.\\n\\n## Articles\\n\\n\u041d\u0430\u0448\u0435\u043b \u043f\u0430\u0440\u0443 \u0445\u043e\u0440\u043e\u0448\u0438\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432, \u0447\u0442\u043e\u0431\u044b \u0441 \u0447\u0435\u0433\u043e \u043d\u0430\u0447\u0430\u0442\u044c:\\n- [devopscube about CKA](https://devopscube.com/cka-exam-study-guide/) - \u043e\u0447\u0435\u043d\u044c \u043c\u043d\u043e\u0433\u043e \u0445\u043e\u0440\u043e\u0448\u0438\u0445 \u0441\u043e\u0432\u0435\u0442\u043e\u0432 \u0438 \u043a\u0440\u043e\u0441\u0441-\u0441\u0441\u044b\u043b\u043e\u043a, \u0434\u043e\u0431\u0430\u0432\u0438\u043b \u0441\u0430\u0439\u0442 \u0432 \u0437\u0430\u043a\u043b\u0430\u0434\u043a\u0438\\n- [medium](https://medium.com/4th-coffee/passing-the-cka-certified-kubernetes-administrator-exam-in-70-minutes-a-detailed-guide-dc945ba4065d) - \u043d\u0430 \u043a\u043e\u043d\u0442\u0440\u0430\u0441\u0442\u0435 \u0441 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0439 \u0441\u0442\u0430\u0442\u044c\u0435\u0439 \u043a\u0430\u043a-\u0442\u043e \u0431\u043b\u0435\u043a\u043b\u043e\\n- [udemy](https://www.udemy.com/course/certified-kubernetes-administrator-with-practice-tests/?ranMID=39197&ranEAID=AfpokvaRFDA&ranSiteID=AfpokvaRFDA-sXs.MeTftBrEzGs26ywPuw&utm_source=aff-campaign&LSNPUBID=AfpokvaRFDA&utm_medium=udemyads) - \u0434\u043b\u044f \u0432\u0438\u0437\u0443\u0430\u043b\u043e\u0432, \u0443\u0447\u0438\u0442\u0435\u043b\u044c \u0438\u0437 \ud83c\uddee\ud83c\uddf3 , \u043a\u0443\u0440\u0441 \u043a\u0430\u043a \u0432\u0441\u0435\u0433\u0434\u0430 \u043b\u0443\u0447\u0448\u0435 \u0431\u0440\u0430\u0442\u044c \u0437\u0430 999\u0440, \u043d\u043e \u043c\u043e\u0436\u043d\u043e \u043d\u0430\u0439\u0442\u0438 \u0438 \u043d\u0430 \u043f\u0438\u0440\u0430\u0442\u0441\u043a\u0438\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u0445\\n\\n## About Exam\\n\\n\u041c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c:\\n- \u0412\u0442\u043e\u0440\u043e\u0439 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\\n- https://kubernetes.io/*  (\u0434\u0430, \u044d\u0442\u043e \u0432\u0430\u0439\u043b\u0434\u043a\u0430\u0440\u0434, \u043c\u043e\u0436\u043d\u043e \u0447\u0438\u0442\u0430\u0442\u044c \u0434\u043e\u043a\u0443 \u0438 \u0431\u043b\u043e\u0433)\\n- https://github.com/kubernetes/\\n\\n\u0413\u043e\u0432\u043e\u0440\u044f\u0442 \u043f\u0440\u043e\u0445\u043e\u0434\u0438\u0442\u044c [`the hard way`](https://github.com/kelseyhightower/kubernetes-the-hard-way) \u043d\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e.\\n\\n| Theme | percentage | comment |\\n| ----- | ---------- | ------- |\\n| Cluster Architecture, Installation & Configuration | 25 % | `kubeadm`, Container Runtime Interface (CRI) |\\n| Workloads & Scheduling | 15 % | `workloads` (configure po,deploy,sts,job,cj,ds and etc.); `nodes` - (drain,cordon,nodeselector,affinity,taint) |\\n| Services & Networking | 20 % | Container Network Interface (CNI) (networking, connectivity between pods - policy, CoreDNS, etc.) |\\n| Storage | 10 % | Container Storage Interface (CSI) - sc,pvc,pv - extend pv and etc (?ceph) |\\n| RBAC | X % | role based access |\\n| Troubleshooting | 30 % | see spoiler |\\n\\n<details>\\n  <summary>Toggle me!</summary>\\n\\n  - What if a node is not ready?\\n  - What if a pod is frequently restarting, and you need to figure out why?\\n  - What if all CPU resource is used up and you need to find out which pod consumes the most and why?\\n  - How to monitor certain resources?\\n  - How to troubleshoot a failed component?\\n  \\n  :::info\\n  For example, if you want to monitor the CPU resource each pod uses or each node uses, do you know what keyword to search in the official documentation?\\n  :::\\n\\n</details>\\n\\n## Cluster Architecture, Installation & Configuration\\n\\n\u0417\u0430\u0432\u0435\u043b \u0443 \u0441\u0435\u0431\u044f \u0434\u043e\u043c\u0430 \u043a\u043b\u0430\u0441\u0442\u0435\u0440, \u043c\u0430\u0441\u0442\u0435\u0440 \u0441 \u043e\u0434\u043d\u0438\u043c \u0432\u043e\u0440\u043a\u0435\u0440\u043e\u043c \u0431\u0435\u0433\u0443\u0442 \u043f\u043e\u0432\u0435\u0440\u0445 `ubuntu-desktop` \u043c\u043e\u0435\u0433\u043e \u0441\u0442\u0430\u0440\u043e\u0433\u043e \u043d\u043e\u0443\u0442\u0431\u0443\u043a\u0430 (4vcpu, 8gb ram), \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e `vagrant+virtualbox`, `containerd` \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0440\u0430\u043d\u0442\u0430\u0439\u043c\u0430 (CRI).\\n\\n\u041c\u044b\u0441\u043b\u044c \u0432 \u0442\u043e\u043c, \u0447\u0442\u043e \u0432 \u043b\u044e\u0431\u043e\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u043c\u043e\u0433\u0443 \u0441 \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u043c\u0438 \u0442\u0435\u043b\u043e\u0434\u0432\u0438\u0436\u0435\u043d\u0438\u044f\u043c\u0438 \u0434\u043e\u043a\u0438\u043d\u0443\u0442\u044c \u0432\u043e\u0440\u043a\u0435\u0440\u043e\u0432 \u0441 \u0434\u0440\u0443\u0433\u0438\u0445 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u043e\u0432 \u0432 \u0434\u043e\u043c\u0430\u0448\u043d\u0435\u0439 \u0441\u0435\u0442\u0438.\\n\\n\u0412\u043e\u0442 [\u0441\u0441\u044b\u043b\u043a\u0430](https://github.com/karma-git/playground/tree/master/environment/vagrant/k8s-cluster) \u043d\u0430 \u043a\u043e\u0434 \u0438 \u0441\u0445\u0435\u043c\u043a\u0430.\\n\\n![img](./static/kubeadm.jpeg)\\n\\n\x3c!--truncate--\x3e"},{"id":"vagrant-karma-linux","metadata":{"permalink":"/Andrew-Horbach.github.io-Public/blog/vagrant-karma-linux","editUrl":"https://github.com/karma-git/Andrew-Horbach.github.io-Public/blob/master/blog/2021-02-01-karma-linux.md","source":"@site/blog/2021-02-01-karma-linux.md","title":"Vagrant - DevOps Environment","description":"\u0421\u043e\u0431\u0440\u0430\u043b Linux \u0434\u043b\u044f \u043b\u044e\u0434\u0435\u0439","date":"2021-02-01T00:00:00.000Z","formattedDate":"February 1, 2021","tags":[{"label":"vagrant","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/vagrant"},{"label":"packer","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/packer"},{"label":"ansible","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/ansible"},{"label":"linux","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/linux"},{"label":"devops","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/devops"}],"readingTime":1.99,"truncated":true,"authors":[{"name":"Andrew Horbach","url":"https://github.com/karma-git","imageURL":"https://github.com/karma-git.png","key":"a.horbach"}],"prevItem":{"title":"CKA","permalink":"/Andrew-Horbach.github.io-Public/blog/cka-commitment"},"nextItem":{"title":"AWS Free Tier \u0438 Packer Tutorial","permalink":"/Andrew-Horbach.github.io-Public/blog/aws-ebs-snapshot"}},"content":"## Inspiration\\n\\n\u0411\u0443\u043a\u0432\u0430\u043b\u044c\u043d\u043e \u043d\u0435\u0434\u0430\u0432\u043d\u043e [\u043f\u0438\u0441\u0430\u043b](blog/selfmade-vagrant-box) \u043f\u0440\u043e \u0441\u0431\u043e\u0440\u043a\u0443 `Vagrant`-\u0430, **\u0434\u043e\u0434\u0435\u043b\u0430\u043b\u044a** :tada:, \u0432 \u0434\u0432\u0443\u0445 \u0432\u0435\u0440\u0441\u0438\u044f\u0445:\\n\\n- \u0432 \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u043c \u0447\u0435\u0440\u0435\u0437 ssh \\n- \u0438 gui, \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u0440\u0430\u0437\u043d\u044b\u0435 desktop \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f :computer:\\n\\n\x3c!-- TODO: codeserver? --\x3e\\n[![asciicast](https://asciinema.org/a/58jLHlUsCZA63uGjIClQcX5r0.svg)](https://asciinema.org/a/58jLHlUsCZA63uGjIClQcX5r0)\\n\\n:::info \\"\u042d\u0442\u0430\u043f\u044b\\"\\n\\n- [\u0421\u0431\u043e\u0440\u043a\u0430 Packer-\u043e\u043c](https://github.com/karma-git/playground/tree/master/environment/vagrant/build)\\n- [Ansible](https://github.com/karma-git/playground/tree/master/ansible)\\n- [Vagrant Cloud](https://app.vagrantup.com/karma-kit)\\n- [Vagrantfile examples](https://github.com/karma-git/playground/tree/master/environment/vagrant/examples)\\n\\n:::\\n\\n\u0418\u043b\u0438 \u0441\u0445\u0435\u043c\u0430\u0442\u0438\u0447\u043d\u043e:\\n\\nimport Mermaid from \'@theme/Mermaid\';\\n\\n<Mermaid chart={`\\n  sequenceDiagram\\n    participant Packer\\n    participant Vagrant\\n    participant Ansible\\n    Packer->>Vagrant: Launch tmp VM\\n    Note right of Vagrant: !NOTE: at low level Vagrant uses Virtualbox API\\n    Vagrant->>Ansible: Configure tmp VM\\n    Ansible--\x3e>Vagrant: Done!\\n    Vagrant--\x3e>Packer: Done!\\n    %% loop Artifact\\n    %%     Ansible->>Packer: Create Vagrant box from current VM state.\\n    %% end\\n    note over Packer: Creates Vagrant box from current VM state.\\n    note over Packer: Releases the Vagrant box on Vagrant Cloud.\\n`}/>\\n\\n## \u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043d\u0430 Windows \\n\\n\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b \u0432\u0430\u0448\u0435\u0439 host OS:\\n\\nCPU\\n```powershell\\nWMIC CPU Get DeviceID,NumberOfCores,NumberOfLogicalProcessors\\n```\\n\u0412\u0435\u0440\u0441\u0438\u044e OS \u0438 \u043e\u0431\u0449\u0438\u0439 \u043e\u0431\u044a\u0435\u043c RAM:\\n```powershell\\nsysteminfo |findstr /c:\\"OS Name\\" /c:\\"Total Physical Memory\\"\\n```\\n![img](static/vagrant-windows.png)\\n\\n:::tip \\"\u0420\u0435\u043a\u043e\u043c\u0435\u0434\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b\\"\\n- 2 vpcu\\n- 4Gi RAM\\n:::\\n\\n\u0412\u0430\u043c \u043f\u043e\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f:\\n- [VirtualBox](https://www.virtualbox.org/wiki/Downloads)\\n- [Vagrant](https://www.vagrantup.com/docs/installation)\\n\\n## VirtualBox Guest Additions\\n\\n> [6.4. Installing the VirtualBox Guest Additions](https://docs.oracle.com/cd/E36500_01/E36502/html/qs-guest-additions.html)\\n\\n:::info\\n\\n\u042d\u0442\u043e, \u043f\u043e\u0436\u0430\u043b\u0443\u0439, \u0441\u0430\u043c\u043e\u0435 \u0431\u043e\u043b\u044c\u043d\u043e\u0435 \u0432 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 virtualbox - \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u0433\u0443\u044e \u043d\u0430 \u0432\u0435\u0441\u044c \u044d\u043a\u0440\u0430\u043d. \u0422\u0443\u0442 \u044f \u043d\u0435 \u0431\u0443\u0434\u0443 \u0432\u0430\u043c \u0434\u0430\u0432\u0430\u0442\u044c \u043d\u0438\u043a\u0430\u043a\u0438\u0445 \u043e\u0431\u0435\u0449\u0430\u043d\u0438\u0439, \u043c\u043e\u0433\u0443 \u043b\u0438\u0448\u044c \u043d\u0430\u043a\u0438\u043d\u0443\u0442\u044c \u0438\u0434\u0435\u0438 \u043a\u0430\u043a \u0432\u0430\u043c \u0441 \u044d\u0442\u0438\u043c \u0441\u043f\u0440\u0430\u0432\u0438\u0442\u044c\u0441\u044f:\\n\\n:::\\n\\n### vbguest vagrant plugin\\n\\n:::danger\\n\u0423 \u043c\u0435\u043d\u044f \u0441\u0440\u0430\u0431\u043e\u0442\u0430\u043b\u043e \u043b\u0438\u0448\u044c \u043e\u0434\u0438\u043d \u0440\u0430\u0437 :skull:\\n:::\\n\\n```shell\\nvagrant plugin uninstall vagrant-vbguest\\nvagrant destroy -f\\nvagrant up\\nvagrant plugin install vagrant-vbguest\\nvagrant vbguest --do install\\n```\\n\\n### ansible galaxy\\n\\n\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043c\u043e\u0439 [\u043f\u0440\u0438\u043c\u0435\u0440](https://github.com/karma-git/playground/tree/master/environment/vagrant/examples/karma-kit-devops-gui) - Guest Additions \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442 ansible \u0440\u043e\u043b\u044c. \\n\\n:::caution\\n\\n\u0413\u0430\u0440\u0430\u043d\u0442\u0438\u044e, \u0447\u0442\u043e \u0443 \u0432\u0430\u0441 \u0432\u0441\u0435 \u0441\u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0434\u0430\u0442\u044c \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e, \u043d\u043e \u0441\u043a\u043e\u0440\u0435\u0435 \u0432\u0441\u0435\u0433\u043e \u043f\u043e\u043d\u0430\u0434\u043e\u0431\u044f\u0442\u0441\u044f \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0435 \u0442\u0435\u043b\u043e\u0434\u0432\u0438\u0436\u0435\u043d\u0438\u044f.\\n\\n:::\\n\\n### \u0421\u0435\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\\n\\n\u0412\u0441\u0435\u0433\u0434\u0430 \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0433\u0443\u0433\u043b\u0438\u0442\u044c / \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u044e\u0442\u0443\u0431 \u043d\u0430 \u0442\u0435\u043c\u0443 \u043a\u0430\u043a \u0441\u0434\u0435\u043b\u0430\u0442\u044c `Virtualbox` \u043d\u0430 \u0432\u0435\u0441\u044c \u044d\u043a\u0440\u0430\u043d :wink:\\n\\n\u0423\u0434\u0430\u0447\u0438 \u0438 \u0434\u0430 \u043f\u0440\u0438\u0431\u0443\u0434\u0435\u0442 \u0441 \u0432\u0430\u043c\u0438 \u0441\u0438\u043b\u0430!\\n\\n:::tip\\n\\n\u0415\u0441\u043b\u0438 \u043d\u0435 \u0441\u043c\u043e\u0442\u0440\u0435\u043b\u0438, \u0438\u0441\u043f\u0440\u0430\u0432\u044c\u0442\u0435\u0441\u044c:\\n\\n<div class=\\"video-wrapper\\">\\n  <iframe  height=\\"540\\" frameborder=\\"0\\" allowfullscreen width=\\"50%\\" src=\\"https://www.youtube.com/embed/n1F_MfLRlX0\\" frameborder=\\"0\\" allowfullscreen></iframe>\\n</div>\\n\\n:::\\n\\n<details>\\n  <summary>Toggle me!</summary>\\n\\n    \ud83e\udd96 \ud83e\udd95\\n\\n</details>\\n\\n## Links\\n\\n:::info Links\\n\\n\u0421\u0441\u044b\u043b\u043a\u0438 / \u0421\u0442\u0430\u0442\u044c\u0438 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u043e\u043c\u043e\u0433\u043b\u0438 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0438\u0434\u0435\u044e:\\n\\n<details>\\n<summary>Links</summary>\\n\\n- [Vagrant - Boxes](https://www.vagrantup.com/docs/boxes)\\n- [Packer - Vagrant](https://www.packer.io/plugins/post-processors/vagrant/vagrant-cloud)\\n- [Manage your workstation with Ansible: Configure desktop settings](https://opensource.com/article/18/5/manage-your-workstation-ansible-part-3)\\n- [Ubuntu 20.04 GUI installation](https://linuxconfig.org/ubuntu-20-04-gui-installation)\\n- [A custom Vagrant box with Packer](https://dev.to/mattdark/a-custom-vagrant-box-with-packer-13ke)\\n- [Packer: \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u0441\u0432\u043e\u0438 vagrant box \u0438 docker image \u0438\u0437 \u043e\u0434\u043d\u043e\u0433\u043e \u043a\u043e\u043d\u0444\u0438\u0433\u0430](https://blog.popstas.ru/blog/2017/03/26/packer-create-vagrant-box-from-ansible-playbook/)\\n- [Enabling VirtualBox Guest Additions in Vagrant](https://subscription.packtpub.com/book/virtualization-and-cloud/9781786464910/1/ch01lvl1sec12/enabling-virtualbox-guest-additions-in-vagrant)\\n- [VBoxManage](https://www.virtualbox.org/manual/ch08.html#vboxmanage-cmd-overview)\\n\\n**github**:\\n- [sys0dm1n/ansible-ubuntu-desktop](https://github.com/sys0dm1n/ansible-ubuntu-desktop)\\n- [pantarei/ansible-playbook-ubuntu-desktop](https://github.com/pantarei/ansible-playbook-ubuntu-desktop)\\n- [PeterMosmans/ansible-role-virtualbox-guest](https://github.com/PeterMosmans/ansible-role-virtualbox-guest)\\n- [dotless-de/vagrant-vbguest/issues/316](https://github.com/dotless-de/vagrant-vbguest/issues/316)\\n- [mesaguy/ansible-hashicorp](https://github.com/mesaguy/ansible-hashicorp)\\n- [andrewrothstein/ansible-starship](https://github.com/andrewrothstein/ansible-starship)\\n\\n</details>\\n\\n:::\\n\\n\x3c!--truncate--\x3e"},{"id":"aws-ebs-snapshot","metadata":{"permalink":"/Andrew-Horbach.github.io-Public/blog/aws-ebs-snapshot","editUrl":"https://github.com/karma-git/Andrew-Horbach.github.io-Public/blob/master/blog/2021-01-30-aws-ebs-snapshots.md","source":"@site/blog/2021-01-30-aws-ebs-snapshots.md","title":"AWS Free Tier \u0438 Packer Tutorial","description":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0435 AWS Free Tier? \u041d\u0430\u0441\u0442\u0440\u043e\u0438\u043b\u0438 Billing Alarms?","date":"2021-01-30T00:00:00.000Z","formattedDate":"January 30, 2021","tags":[{"label":"aws","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/aws"},{"label":"cloud","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/cloud"},{"label":"packer","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/packer"},{"label":"billing","permalink":"/Andrew-Horbach.github.io-Public/blog/tags/billing"}],"readingTime":1.09,"truncated":true,"authors":[{"name":"Andrew Horbach","url":"https://github.com/karma-git","imageURL":"https://github.com/karma-git.png","key":"a.horbach"}],"prevItem":{"title":"Vagrant - DevOps Environment","permalink":"/Andrew-Horbach.github.io-Public/blog/vagrant-karma-linux"}},"content":"# \u041f\u0440\u0435\u0434\u044b\u0441\u0442\u043e\u0440\u0438\u044f\\n\\n\u041a\u043e\u0433\u0434\u0430 \u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0437\u043d\u0430\u043a\u043e\u043c\u0438\u043b\u0441\u044f \u0441 AWS \u043f\u043e youtube \u043f\u043b\u0435\u0439\u043b\u0438\u0441\u0442\u0443, \u044f \u0441\u043c\u0430\u0441\u0442\u0435\u0440\u0438\u043b `VPC` \u0432 \u0434\u0432\u0443\u0445 `AZ` \u0441 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u043c\u0438 \u043f\u043e\u0434\u0441\u0435\u0442\u044f\u043c\u0438. \u041e\u0434\u0438\u043d \u0438\u0437 \u0442\u0438\u043f\u043e\u0432 \u043f\u043e\u0434\u0441\u0435\u0442\u0435\u0439 \u0431\u044b\u043b private - \u0441 `nat-gateway`, \u0432 \u043a\u0443\u0440\u0441\u0430\u0445 \u0437\u0430\u0431\u044b\u043b\u0438 \u0441\u043a\u0430\u0437\u0430\u0442\u044c, \u0447\u0442\u043e \u043e\u043d\u0438 \u043d\u0435 \u0432\u0445\u043e\u0434\u044f\u0442 \u0432\u043e \u0444\u0440\u0438\u0442\u0438\u0440. \u0417\u0430 \u043f\u0430\u0440\u0443 \u0434\u043d\u0435\u0439 \u0437\u0430 2 \u0433\u0435\u0439\u0442\u0430 \u043d\u0430\u043a\u0430\u043f\u0430\u043b\u043e \u043e\u043a\u043e\u043b\u043e **$6**. \u0411\u044b\u043b\u043e \u043e\u0431\u0438\u0434\u043d\u043e, \u044f \u043f\u043e\u0441\u0442\u0430\u0432\u0438\u043b \u0431\u0438\u043b\u043b\u0438\u043d\u0433 \u0430\u043b\u0430\u0440\u043c.\\n\\n:::info #!NOTE\\n\u0422\u043e\u0442 \u0441\u0430\u043c\u044b\u0439 \u043a\u0443\u0440\u0441 \u043e\u0442 [\u041a\u0443\u0440\u0441 ADV-IT](https://www.youtube.com/watch?v=8jbx8O3wuLg&list=PLg5SS_4L6LYsxrZ_4xE_U95AtGsIB96k9)\\n:::\\n\\n# \u0418\u0441\u0442\u043e\u0440\u0438\u044f\\n\\n\u0421\u043e\u0432\u0441\u0435\u043c \u043d\u0435\u0434\u0430\u0432\u043d\u043e \u044f \u0443\u0447\u0438\u043b\u0441\u044f (\u043d\u0430 \u043a\u043e\u0442\u0438\u043a\u0430\u0445) \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044e \u0430\u0440\u0442\u0435\u0444\u0430\u043a\u0442\u043e\u0432 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e [packer](./blog/selfmade-vagrant-box). \u041f\u043e\u0441\u043b\u0435 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0438 \u0432 AWS \u044f \u0441\u043e \u0441\u043f\u043e\u043a\u043e\u0439\u043d\u043e\u0439 \u0434\u0443\u0448\u043e\u0439 \u0432 console \u043d\u0443\u0436\u043d\u043e\u0433\u043e \u0440\u0435\u0433\u0438\u043e\u043d\u0430 \u0443\u0431\u0438\u043b \u0432\u0441\u0435 `AMI` \u0438 \u043f\u043e\u0448\u0435\u043b \u0434\u0430\u043b\u044c\u0448\u0435.\\n\\n\u041d\u0435\u0434\u0435\u043b\u044e \u0441\u043f\u0443\u0441\u0442\u044f \u0432 \u043f\u043e\u0447\u0442\u0435 \u0437\u0430\u043c\u0435\u0442\u0438\u043b \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u0435 \u043f\u0438\u0441\u044c\u043c\u043e \u043e\u0442 AWS (\u043c\u043d\u0435 \u0438\u043d\u043e\u0433\u0434\u0430 \u043d\u0430 \u043b\u0438\u0447\u043d\u044b\u0439 gmail \u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u043f\u0440\u0438\u0445\u043e\u0434\u044f\u0442 \u043e\u0442 \u043d\u0438\u0445 billing \u0440\u0435\u043f\u043e\u0440\u0442\u044b, \u0432\u0441\u0435\u0433\u0434\u0430 \u043f\u0443\u0441\u0442\u044b\u0435, \u0438 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u044f \u043d\u0435 [re:invent](https://reinvent.awsevents.com/)).\\n\\n![alert](./static/aws-ebs-snapshot-warn.png)\\n\\n\u0423\u0432\u0438\u0434\u0435\u043b \u0447\u0442\u043e \u044f \u043f\u043e\u0442\u0440\u0430\u0442\u0438\u043b 85% _\\"\u0444\u0440\u0438-\u0442\u0438\u0440\u043d\u043e\u0433\u043e\\"_ \u043c\u0435\u0441\u0442\u0430 \u043f\u043e\u0434 \u0441\u043d\u044d\u043f\u0448\u043e\u0442\u044b ebs \u0434\u0438\u0441\u043a\u043e\u0432.\\n\\n:::info\\n[AWS Free Tier](https://aws.amazon.com/free/?all-free-tier.sort-by=item.additionalFields.SortRank&all-free-tier.sort-order=asc&awsf.Free%20Tier%20Types=*all&awsf.Free%20Tier%20Categories=*all) - \u0442\u0443\u0442 \u043c\u043e\u0436\u043d\u043e \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0432\u0430\u043c \u0432 \u043c\u0435\u0441\u044f\u0446 \u0432\u044b\u0434\u0435\u043b\u044f\u0435\u0442\u0441\u044f \u0442\u043e\u0433\u043e \u0438\u043b\u0438 \u0438\u043d\u043e\u0433\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u0430 \u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u043e \u0432 \u0440\u0430\u043c\u043a\u0430\u0445 \u0444\u0440\u0438-\u0442\u0438\u0440\u0430.\\n:::\\n\\n\u0410\u0433\u0430 - \u0438\u0437-\u0437\u0430 \u043d\u0435\u0433\u043e\u0434\u044f\u044f `packer`-\u0430 \u043f\u043e\u043c\u0438\u043c\u043e `AMI`-\u0448\u0435\u043a \u0441\u043e\u0437\u0434\u0430\u044e\u0442\u0441\u044f \u0435\u0449\u0435 \u0438 \u0442\u0430\u043a\u0438\u0435 \u0441\u0443\u0449\u043d\u043e\u0441\u0442\u0438.\\n\\n![snapshots](./static/aws-console.png)\\n\\n:::tip \u041c\u043e\u0440\u0430\u043b\u044c\\n- \u043f\u0435\u0440\u043c\u044b\u043c \u0434\u0435\u043b\u043e\u043c \u0432\u043e \u0444\u0440\u0438-\u0442\u0438\u0440\u0435 \u0441\u0434\u0435\u043b\u0430\u0439\u0442\u0435 \u043d\u0435 \u0440\u0443\u0442\u043e\u0432\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u0432\u0442\u043e\u0440\u044b\u043c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435 [\u0431\u0438\u043b\u043b\u0438\u043d\u0433 \u0430\u043b\u0435\u0440\u0442\u044b](https://www.youtube.com/watch?v=XNeAH4dch0g) (\u044f \u0431\u044b \u043f\u043e\u0441\u0442\u0430\u0432\u0438\u043b \u0442\u0440\u0435\u0448\u0445\u043e\u043b\u0434 \u043d\u0430 50% - \u0432 \u043c\u043e\u0435\u043c \u0441\u043b\u0443\u0447\u0430\u0435 \u0431\u044e\u0434\u0436\u0435\u0442 \u0442\u0430\u044f\u043b \u0431\u044b\u0441\u0442\u0440\u043e). \\n- \u0410\u0432\u0442\u043e\u0440\u0430\u043c \u0432\u0438\u0434\u0435\u043e / \u0433\u0430\u0439\u0434\u043b\u0430\u0439\u043d\u043e\u0432, \u043a\u043e\u043d\u0435\u0447\u043d\u043e, \u0441\u0442\u043e\u0438\u043b\u043e \u0431\u044b \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c, \u0447\u0442\u043e \u044d\u0442\u043e \u043d\u0435 \u0432\u0445\u043e\u0434\u0438\u0442 \u0432\u043e \u0444\u0440\u0438-\u0442\u0438\u0440 - \u0438\u043b\u0438 \u0432\u0445\u043e\u0434\u0438\u0442, \u043d\u043e \u0441\u043b\u0430\u0431\u044b\u0435 \u043b\u0438\u043c\u0438\u0442\u044b.\\n:::\\n\x3c!--truncate--\x3e"}]}')}}]);